!function(e){var r={};function o(n){if(r[n])return r[n].exports;var s=r[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=r,o.d=function(e,r,n){o.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,r){if(1&r&&(e=o(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var s in e)o.d(n,s,function(r){return e[r]}.bind(null,s));return n},o.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(r,"a",r),r},o.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},o.p="",o(o.s=1)}([function(e,r,o){"use strict";var n=o(12).createConnection({host:process.env.DB_HOST,user:process.env.DB_USER,password:process.env.DB_PASSWORD,database:process.env.DB_NAME});n.connect(),console.log(n.state),n.query("SELECT 1 + 1 AS solution",function(e,r,o){if(e)throw e;console.log("The solution is: ",r[0].solution)}),e.exports=n},function(e,r,o){"use strict";o(2);var n=o(3),s=n(),t=o(4),i=o(5),u=o(6),c=o(7),l=o(8),a=o(9)(i),f=o(10).Strategy,p=o(11).config();p.error&&console.log(p.error),console.log(p.parsed);var d={host:process.env.DB_HOST,user:process.env.DB_USER,password:process.env.DB_PASSWORD,database:process.env.DB_NAME};console.log(process.cwd());var g=o(0);s.use(n.static("public/scripts/")),s.use(t.urlencoded({extended:!0})),s.use(l());var v=new a(d);s.use(i({secret:"aooeiperncgdr",resave:"false",saveUninitialized:!1,store:v})),s.use(u.initialize()),s.use(u.session()),u.use(new f(function(e,r,n){o(0).query("SELECT password FROM users WHERE username = ?",[e],function(o,s,t){if(o&&n(o),console.log("gets here"),0==s.length)n(null,!1);else{var i=s[0].password.toString();c.compare(r,i,function(r,o){return n(null,!!o&&{userid:e})})}})})),s.get("/login",function(e,r){r.render("login.ejs")}),s.post("/login",u.authenticate("local",{successRedirect:"/",failureRedirect:"/login"})),s.get("/",function(e,r,o){if(e.isAuthenticated())return o();r.redirect("/login")},function(e,r){r.render("index.ejs",{username:e.user.userid}),console.log(e.user),console.log("Cookies: ",e.cookies),console.log("Signed Cookies: ",e.signedCookies)}),s.get("/register",function(e,r){r.render("register.ejs")}),s.post("/register",function(e,r){var n=e.body.username,s=e.body.password,t=o(0);c.hash(s,10,function(o,s){t.query("INSERT INTO users(username, email, password) VALUES (?,?,?)",[n,"",s],function(o,n,s){if(o)throw o;t.query("SELECT LAST_INSERT_ID() as userid",function(o,n,s){if(o)throw o;e.login(n.userid,function(e){r.redirect("/")})})})})}),s.post("/postcomment",function(e,r){var o=e.user.userid,n=e.body.comment;g.query("INSERT INTO comments(comment, userid) VALUES (?,?)",[n,o],function(e,o,n){if(e)throw e;r.redirect("/")})}),s.get("/logout",function(e,r){e.logout(),e.session.destroy(),r.redirect("/login")}),u.serializeUser(function(e,r){r(null,e)}),u.deserializeUser(function(e,r){r(null,e)}),s.listen(8080,function(){console.log("Server is online")})},function(e,r){e.exports=require("path")},function(e,r){e.exports=require("express")},function(e,r){e.exports=require("body-parser")},function(e,r){e.exports=require("express-session")},function(e,r){e.exports=require("passport")},function(e,r){e.exports=require("bcrypt")},function(e,r){e.exports=require("cookie-parser")},function(e,r){e.exports=require("express-mysql-session")},function(e,r){e.exports=require("passport-local")},function(e,r){e.exports=require("dotenv")},function(e,r){e.exports=require("mysql")}]);