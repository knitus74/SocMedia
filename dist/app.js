!function(e){var r={};function n(o){if(r[o])return r[o].exports;var t=r[o]={i:o,l:!1,exports:{}};return e[o].call(t.exports,t,t.exports,n),t.l=!0,t.exports}n.m=e,n.c=r,n.d=function(e,r,o){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var t in e)n.d(o,t,function(r){return e[r]}.bind(null,t));return o},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="",n(n.s=1)}([function(e,r,n){"use strict";var o=n(12).createConnection({host:process.env.DB_HOST,user:process.env.DB_USER,password:process.env.DB_PASSWORD,database:process.env.DB_NAME});o.connect(),console.log(o.state),o.query("SELECT 1 + 1 AS solution",function(e,r,n){if(e)throw e;console.log("The solution is: ",r[0].solution)}),e.exports=o},function(e,r,n){"use strict";n(2);var o=n(3),t=o(),s=n(4),i=n(5),u=n(6),c=n(7),a=n(8),l=n(9)(i),f=n(10).Strategy,d=n(11).config();d.error&&console.log(d.error),console.log(d.parsed);var p={host:process.env.DB_HOST,user:process.env.DB_USER,password:process.env.DB_PASSWORD,database:process.env.DB_NAME};console.log(process.cwd());var m=n(0);t.use(o.static("dist/")),t.use(s.urlencoded({extended:!0})),t.use(s.json()),t.use(a());var g=new l(p);t.use(i({secret:"aooeiperncgdr",resave:"false",saveUninitialized:!1,store:g})),t.use(u.initialize()),t.use(u.session()),u.use(new f(function(e,r,o){n(0).query("SELECT password, userid FROM users WHERE username = ?",[e],function(n,t,s){if(n&&o(n),console.log("gets here"),0==t.length)o(null,!1);else{var i=t[0].password.toString();c.compare(r,i,function(r,n){if(n){var s=t[0].userid;return o(null,{userid:s,username:e})}return o(null,!1)})}})})),t.get("/login",function(e,r){r.render("login.ejs")}),t.post("/login",u.authenticate("local",{successRedirect:"/",failureRedirect:"/login"})),t.get("/",function(e,r,n){if(e.isAuthenticated())return n();r.redirect("/login")},function(e,r){r.render("index.ejs",{username:e.user.username})}),t.get("/register",function(e,r){r.render("register.ejs")}),t.post("/register",function(e,r){var o=e.body.username,t=e.body.password,s=n(0);c.hash(t,10,function(n,t){s.query("INSERT INTO users(username, email, password) VALUES (?,?,?)",[o,"",t],function(n,o,t){if(n)throw n;s.query("SELECT LAST_INSERT_ID() as userid",function(n,o,t){if(n)throw n;e.login(o.userid,function(e){r.redirect("/")})})})})}),t.post("/postcomment",function(e,r){var n=e.user.userid,o=e.body.comment;m.query("INSERT INTO comments(comment, userid) VALUES (?,?)",[o,n],function(e,n,o){if(e)throw e;m.query("SELECT LAST_INSERT_ID() as comment_id",function(e,n,o){if(e)throw e;var t=n[0].comment_id;r.send(JSON.stringify({comment_id:t}))})})}),t.post("/deletecomment",function(e,r){e.user.userid;var n=e.body.comment_id;console.log(n),m.query("DELETE FROM comments WHERE commentid = ?",[n],function(e,r,n){if(e)throw e})}),t.get("/logout",function(e,r){e.logout(),e.session.destroy(),r.redirect("/login")}),t.get("/getcomments",function(e,r){var n=e.user.userid;m.query("SELECT commentid, comment FROM comments WHERE userid = ?",[n],function(e,n,o){if(e)throw e;var t=JSON.stringify(n);r.send(t)})}),t.get("/profiles/:username",function(e,r){var n=e.params.username;m.query("SELECT comment FROM comments INNER JOIN users ON comments.userid = users.userid WHERE username = ?",[n],function(e,o,t){if(e)throw e;console.log(o),r.render("profile.ejs",{username:n,comments:o})})}),u.serializeUser(function(e,r){r(null,e)}),u.deserializeUser(function(e,r){r(null,e)}),t.listen(8080,function(){console.log("Server is online")})},function(e,r){e.exports=require("path")},function(e,r){e.exports=require("express")},function(e,r){e.exports=require("body-parser")},function(e,r){e.exports=require("express-session")},function(e,r){e.exports=require("passport")},function(e,r){e.exports=require("bcrypt")},function(e,r){e.exports=require("cookie-parser")},function(e,r){e.exports=require("express-mysql-session")},function(e,r){e.exports=require("passport-local")},function(e,r){e.exports=require("dotenv")},function(e,r){e.exports=require("mysql")}]);