!function(e){var o={};function r(n){if(o[n])return o[n].exports;var t=o[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=e,r.c=o,r.d=function(e,o,n){r.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,o){if(1&o&&(e=r(e)),8&o)return e;if(4&o&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&o&&"string"!=typeof e)for(var t in e)r.d(n,t,function(o){return e[o]}.bind(null,t));return n},r.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(o,"a",o),o},r.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},r.p="",r(r.s=1)}([function(e,o,r){"use strict";var n=r(12).createConnection({host:process.env.DB_HOST,user:process.env.DB_USER,password:process.env.DB_PASSWORD,database:process.env.DB_NAME});n.connect(),console.log(n.state),n.query("SELECT 1 + 1 AS solution",function(e,o,r){if(e)throw e;console.log("The solution is: ",o[0].solution)}),e.exports=n},function(e,o,r){"use strict";r(2);var n=r(3),t=n(),s=r(4),i=r(5),u=r(6),c=r(7),l=r(8),a=r(9)(i),f=r(10).Strategy,d=r(11).config();d.error&&console.log(d.error),console.log(d.parsed);var p={host:process.env.DB_HOST,user:process.env.DB_USER,password:process.env.DB_PASSWORD,database:process.env.DB_NAME};console.log(process.cwd());var g=r(0);t.use(n.static("dist/")),t.use(s.urlencoded({extended:!0})),t.use(s.json()),t.use(l());var m=new a(p);t.use(i({secret:"aooeiperncgdr",resave:"false",saveUninitialized:!1,store:m})),t.use(u.initialize()),t.use(u.session()),u.use(new f(function(e,o,n){r(0).query("SELECT password FROM users WHERE username = ?",[e],function(r,t,s){if(r&&n(r),console.log("gets here"),0==t.length)n(null,!1);else{var i=t[0].password.toString();c.compare(o,i,function(o,r){return n(null,!!r&&{userid:e})})}})})),t.get("/login",function(e,o){o.render("login.ejs")}),t.post("/login",u.authenticate("local",{successRedirect:"/",failureRedirect:"/login"})),t.get("/",function(e,o,r){if(e.isAuthenticated())return r();o.redirect("/login")},function(e,o){o.render("index.ejs",{username:e.user.userid}),console.log(e.user),console.log("Cookies: ",e.cookies),console.log("Signed Cookies: ",e.signedCookies)}),t.get("/register",function(e,o){o.render("register.ejs")}),t.post("/register",function(e,o){var n=e.body.username,t=e.body.password,s=r(0);c.hash(t,10,function(r,t){s.query("INSERT INTO users(username, email, password) VALUES (?,?,?)",[n,"",t],function(r,n,t){if(r)throw r;s.query("SELECT LAST_INSERT_ID() as userid",function(r,n,t){if(r)throw r;e.login(n.userid,function(e){o.redirect("/")})})})})}),t.post("/postcomment",function(e,o){var r=e.user.userid,n=e.body.comment;g.query("INSERT INTO comments(comment, userid) VALUES (?,?)",[n,r],function(e,r,n){if(e)throw e;o.redirect("/")})}),t.post("/deletecomment",function(e,o){e.user.userid;var r=e.body.comment_id;console.log(r),g.query("DELETE FROM comments WHERE commentid = ?",[r],function(e,o,r){if(e)throw e})}),t.get("/logout",function(e,o){e.logout(),e.session.destroy(),o.redirect("/login")}),t.get("/getcomments",function(e,o){var r=e.user.userid;g.query("SELECT commentid, comment FROM comments WHERE userid = ?",[r],function(e,r,n){if(e)throw e;console.log(r);var t=JSON.stringify(r);o.send(t)})}),u.serializeUser(function(e,o){o(null,e)}),u.deserializeUser(function(e,o){o(null,e)}),t.listen(8080,function(){console.log("Server is online")})},function(e,o){e.exports=require("path")},function(e,o){e.exports=require("express")},function(e,o){e.exports=require("body-parser")},function(e,o){e.exports=require("express-session")},function(e,o){e.exports=require("passport")},function(e,o){e.exports=require("bcrypt")},function(e,o){e.exports=require("cookie-parser")},function(e,o){e.exports=require("express-mysql-session")},function(e,o){e.exports=require("passport-local")},function(e,o){e.exports=require("dotenv")},function(e,o){e.exports=require("mysql")}]);